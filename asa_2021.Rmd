---
title: "ASA Data Challenge Expo"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1: Overview
### Introduction

* Name: Walter Yu
* Date: Fall 2020

This notebook is the contest entry to the [ASA Data Challenge Expo][00.00] to help citizens and communities response to COVID-19 with U.S. Census data analysis from the sources listed in the following sections.

[00.00]: https://community.amstat.org/dataexpo/home

### Data Sources

Both core and supplemental datasets from the [problem statement][00.01] were used for this analysis. Data was downloaded from portal websites as follows:

1. U.S. Census Website: Advanced [search feature][00.02] was used to filter data in the following order: Surveys > Years > Geography > Topics
2. U.S. Census COVID-19 Website: CA state data was downloaded from the [categorical dataset search page][00.03]

[00.01]: https://opportunity.census.gov/assets/files/covid-19-top-asa-problem-statement.pdf
[00.02]: https://data.census.gov/cedsci/advanced
[00.03]: https://covid19.census.gov/

### Core Datasets

1. 2019 American Community Survey (ACS) Single-Year Estimates - Language Spoken
* Description: PLACE OF BIRTH BY LANGUAGE SPOKEN AT HOME AND ABILITY TO SPEAK ENGLISH IN THE UNITED STATES
* Survey/Program: American Community Survey
* Years: 2019,2018,2017,2016,2015,2014,2013,2012,2011,2010
* Table: [B06007][01.00]

[01.00]: https://data.census.gov/cedsci/table?q=B06007&tid=ACSDT1Y2019.B06007

2. 2019 American Community Survey (ACS) Single-Year Estimates - Household Income
* Description: HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 2019 INFLATION-ADJUSTED DOLLARS)
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B19001][01.01]

[01.01]: https://data.census.gov/cedsci/table?text=B19001&tid=ACSDT1Y2019.B19001

3. 2019 American Community Survey (ACS) Single-Year Estimates - Median Household Income
* Description: MEDIAN HOUSEHOLD INCOME IN THE PAST 12 MONTHS (IN 2019 INFLATION-ADJUSTED DOLLARS)
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B19013][01.02]

[01.02]: https://data.census.gov/cedsci/table?text=B19013&tid=ACSDT1Y2019.B19013

4. 2019 American Community Survey (ACS) Single-Year Estimates - Poverty Status
* Description: POVERTY STATUS IN THE PAST 12 MONTHS BY SEX BY AGE
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B17001][01.03]

[01.03]: https://data.census.gov/cedsci/table?text=B17001&tid=ACSDT1Y2019.B17001

5. 2019 American Community Survey (ACS) Single-Year Estimates - Housing Cost
* Description: MONTHLY HOUSING COSTS
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B25104][01.04]

[01.04]: https://data.census.gov/cedsci/table?text=B25104&tid=ACSDT1Y2019.B25104

6. 2019 American Community Survey (ACS) Single-Year Estimates - Education Attainment
* Description: EDUCATIONAL ATTAINMENT FOR THE POPULATION 25 YEARS AND OVER
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B15003][01.05]

[01.05]: https://data.census.gov/cedsci/table?text=B15003&tid=ACSDT1Y2019.B15003

7. 2019 American Community Survey (ACS) Single-Year Estimates - Commute Mode
* Description: MEANS OF TRANSPORTATION TO WORK BY AGE
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B08101][01.06]

[01.06]: https://data.census.gov/cedsci/table?text=B08101&tid=ACSDT1Y2019.B08101

8. 2019 American Community Survey (ACS) Single-Year Estimates - Race
* Description: RACE
* Survey/Program: American Community Survey
* Years: 2019
* Table: [B02001][01.07]

[01.07]: https://data.census.gov/cedsci/table?text=B02001&tid=ACSDT1Y2019.B02001

### Supplemental Datasets

1. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [California Counties DP02 Social][02.00]

[02.00]: https://covid19.census.gov/datasets/california-counties-dp02-social

2. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [California Counties DP03 Economic][02.01]

[02.01]: https://covid19.census.gov/datasets/california-counties-dp03-economic

3. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [California Counties DP04 Housing][02.02]

[02.02]: https://covid19.census.gov/datasets/california-counties-dp04-housing

4. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [California Counties DP05 Demographic][02.03]

[02.03]: https://covid19.census.gov/datasets/california-counties-dp05-demographic

5. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [Household Pulse Survey Public Use File][02.04]

[02.04]: https://www.census.gov/programs-surveys/household-pulse-survey/datasets.html

6. U.S. Census - COVID-19 Demographic and Economic Resources
* Dataset: [COVID-19 Case Surveillance Public Use Data][02.05]

[02.05]: https://data.cdc.gov/Case-Surveillance/COVID-19-Case-Surveillance-Public-Use-Data/vbim-akqf

### Geospatial Datasets

1. U.S. Census - COVID-19 Demographic and Economic Resources
* Description: American Community Survey (ACS) about household income ranges and cutoffs and Poverty Status.
* These are 5-year estimates shown by state and county boundaries.
* Link: [Dataset][03.00]

[03.00]: https://uscensus.maps.arcgis.com/home/item.html?id=b2ba19b4cce04a9796d9cdeecaba2f18

2. U.S. Census - COVID-19 Demographic and Economic Resources
* Description: American Community Survey (ACS) about household income ranges and cutoffs.
* These are 5-year estimates shown by county, and state boundaries.
* Link: [Dataset][03.01]

[03.01]: https://uscensus.maps.arcgis.com/home/item.html?id=0fbb1571e5b6458f941580d1d64a6693

3. U.S. Census - COVID-19 Demographic and Economic Resources
* Description: American Community Survey (ACS) about total population count by sex and age group.
* These are 5-year estimates shown by state and county boundaries.
* Link: [Dataset][03.02]

[03.02]: https://uscensus.maps.arcgis.com/home/item.html?id=eab0f44ba5184c609175caa7ae317f0c

## Part 2: Data Processing

```{r echo=TRUE}

# data processing package
library(dplyr)

# data source: U.S. Census Data Portal
acs19_language <- read.csv(
    # "data/https://data.census.gov/cedsci/table?q=B06007&tid=ACSDT1Y2019.B06007.csv"
    "data/ACSDT1Y2019.B06007_data_with_overlays_2020-11-18T232550.csv"
)

# data source: U.S. Census Data Portal
acs19_hh_income <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B19001&tid=ACSDT1Y2019.B19001.csv"
    "data/ACSDT1Y2019.B19001_data_with_overlays_2020-11-22T010349.csv"
)

# data source: U.S. Census Data Portal
acs19_hh_income_median <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B19013&tid=ACSDT1Y2019.B19013.csv"
    "data/ACSDT1Y2019.B19013_data_with_overlays_2020-11-22T035924.csv"
)

# data source: U.S. Census Data Portal
acs19_poverty <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B17001&tid=ACSDT1Y2019.B17001.csv"
    "data/ACSDT1Y2019.B17001_data_with_overlays_2020-11-22T010613.csv"
)

# data source: U.S. Census Data Portal
acs19_housing <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B25104&tid=ACSDT1Y2019.B25104.csv"
    "data/ACSDT1Y2019.B25104_data_with_overlays_2020-11-22T003237.csv"
)

# data source: U.S. Census Data Portal
acs19_education <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B15003&tid=ACSDT1Y2019.B15003.csv"
    "data/ACSDT1Y2019.B15003_data_with_overlays_2020-11-22T004032.csv"
)

# data source: U.S. Census Data Portal
acs19_commute <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B08101&tid=ACSDT1Y2019.B08101.csv"
    "data/ACSDT1Y2019.B08101_data_with_overlays_2020-11-22T004429.csv"
)

# data source: U.S. Census Data Portal
acs19_race <- read.csv(
    # "data/https://data.census.gov/cedsci/table?text=B02001&tid=ACSDT1Y2019.B02001.csv"
    "data/ACSDT1Y2019.B02001_data_with_overlays_2020-11-22T010027.csv"
)

# show table dim
print("Show table dimensions below:")
dim(acs19_language)
dim(acs19_hh_income)
dim(acs19_hh_income_median)
dim(acs19_poverty)
dim(acs19_housing)
dim(acs19_education)
dim(acs19_commute)
dim(acs19_race)

# remove first row
acs19_language = acs19_language[-1, ]
acs19_hh_income = acs19_hh_income[-1, ]
acs19_hh_income_median = acs19_hh_income_median[-1, ]
acs19_poverty = acs19_poverty[-1, ]
acs19_housing = acs19_housing[-1, ]
acs19_education = acs19_education[-1, ]
acs19_commute = acs19_commute[-1, ]
acs19_race = acs19_race[-1, ]

# preview table rows
# print("Preview table rows below:")
# head(acs19_language)
# head(acs19_hh_income)
# head(acs19_hh_income_median)
# head(acs19_poverty)
# head(acs19_housing)
# head(acs19_education)
# head(acs19_commute)
# head(acs19_race)

# subset each table before join
# 1. 2019 American Community Survey (ACS) Single-Year Estimates - Language Spoken
# * Table: [B06007]
# * Columns:
# 	B06007_002E: Speak only English
# 	B06007_004E: Speak Spanish:!!Speak English "very well"
# 	B06007_005E: Speak other languages:!!Speak English "very well"

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_lang = c(
		"GEO_ID",
		"B06007_002E",
		"B06007_004E",
		"B06007_005E"
)
a19lang = acs19_language[var_lang]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19lang = a19lang %>%
  rename(
    lang_english = B06007_002E,
    lang_spanish = B06007_004E,
    lang_other = B06007_005E
    )

# show table dim
print("Show table dimensions below:")
head(a19lang)
dim(a19lang)

# 2. 2019 American Community Survey (ACS) Single-Year Estimates - Household Income
# * Table: [B19001]
# * Columns:
#   B19001_002E: Estimate!!Total:!!Less than $10,000
#   B19001_003E: Estimate!!Total:!!$10,000 to $14,999
#   B19001_004E: Estimate!!Total:!!$15,000 to $19,999
#   B19001_005E: Estimate!!Total:!!$20,000 to $24,999
#   B19001_006E: Estimate!!Total:!!$25,000 to $29,999
#   B19001_007E: Estimate!!Total:!!$30,000 to $34,999
#   B19001_008E: Estimate!!Total:!!$35,000 to $39,999
#   B19001_009E: Estimate!!Total:!!$40,000 to $44,999
#   B19001_010E: Estimate!!Total:!!$45,000 to $49,999
#   B19001_011E: Estimate!!Total:!!$50,000 to $59,999
#   B19001_012E: Estimate!!Total:!!$60,000 to $74,999
#   B19001_013E: Estimate!!Total:!!$75,000 to $99,999
#   B19001_014E: Estimate!!Total:!!$100,000 to $124,999
#   B19001_015E: Estimate!!Total:!!$125,000 to $149,999
#   B19001_016E: Estimate!!Total:!!$150,000 to $199,999
#   B19001_017E: Estimate!!Total:!!$200,000 or more

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_hh = c(
  "GEO_ID",
  "B19001_002E",
  "B19001_003E",
  "B19001_004E",
  "B19001_005E",
  "B19001_006E",
  "B19001_007E",
  "B19001_008E",
  "B19001_009E",
  "B19001_010E",
  "B19001_011E",
  "B19001_012E",
  "B19001_013E",
  "B19001_014E",
  "B19001_015E",
  "B19001_016E",
  "B19001_017E")
a19hh = acs19_hh_income[var_hh]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19hh = a19hh %>%
  rename(
    hh_less_10k = B19001_002E,
    hh_10k = B19001_003E,
    hh_15k = B19001_004E,
    hh_20k = B19001_005E,
    hh_25k = B19001_006E,
    hh_30k = B19001_007E,
    hh_35k = B19001_008E,
    hh_40k = B19001_009E,
    hh_45k = B19001_010E,
    hh_50k = B19001_011E,
    hh_60k = B19001_012E,
    hh_75k = B19001_013E,
    hh_100k = B19001_014E,
    hh_125k = B19001_015E,
    hh_150k = B19001_016E,
    hh_200k = B19001_017E
    )

# show table dim
print("Show table dimensions below:")
head(a19hh)
dim(a19hh)

# 3. 2019 American Community Survey (ACS) Single-Year Estimates - Median Household Income
# * Table: [B19013]
# * Columns:
#   B19013_001E: Estimate!!Median household income in the past 12 months

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_hh_median = c(
	"GEO_ID",
    "B19013_001E"
	)
a19hh_median = acs19_hh_income_median[var_hh_median]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19hh_median = a19hh_median %>%
  rename(
    hh_median = B19013_001E
    )

# show table dim
print("Show table dimensions below:")
head(a19hh_median)
dim(a19hh_median)

# 4. 2019 American Community Survey (ACS) Single-Year Estimates - Poverty Status
# * Table: [B17001]
# * Columns:
# B17001_002E: Estimate!!Total:!!Income in the past 12 months below poverty level:
# B17001_031E: Estimate!!Total:!!Income in the past 12 months at or above poverty level:

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_poverty = c(
	"GEO_ID",
    "B17001_002E",
    "B17001_031E"
	)
a19poverty = acs19_poverty[var_poverty]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19poverty = a19poverty %>%
  rename(
	poverty_below = B17001_002E,
	poverty_above = B17001_031E,
    )

# show table dim
print("Show table dimensions below:")
head(a19poverty)
dim(a19poverty)

# 5. 2019 American Community Survey (ACS) Single-Year Estimates - Housing Cost
# * Table: [B25104]
# * Columns:
#   B25104_002E: Estimate!!Total:!!Less than $100
#   B25104_003E: Estimate!!Total:!!$100 to $199
#   B25104_004E: Estimate!!Total:!!$200 to $299
#   B25104_005E: Estimate!!Total:!!$300 to $399
#   B25104_006E: Estimate!!Total:!!$400 to $499
#   B25104_007E: Estimate!!Total:!!$500 to $599
#   B25104_008E: Estimate!!Total:!!$600 to $699
#   B25104_009E: Estimate!!Total:!!$700 to $799
#   B25104_010E: Estimate!!Total:!!$800 to $899
#   B25104_011E: Estimate!!Total:!!$900 to $999
#   B25104_012E: Estimate!!Total:!!$1,000 to $1,499
#   B25104_013E: Estimate!!Total:!!$1,500 to $1,999
#   B25104_014E: Estimate!!Total:!!$2,000 to $2,499
#   B25104_015E: Estimate!!Total:!!$2,500 to $2,999
#   B25104_016E: Estimate!!Total:!!$3,000 or more
#   B25104_017E: Estimate!!Total:!!No cash rent

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_housing = c(
	"GEO_ID",
    "B25104_002E",
    "B25104_003E",
    "B25104_004E",
    "B25104_005E",
    "B25104_006E",
    "B25104_007E",
    "B25104_008E",
    "B25104_009E",
    "B25104_010E",
    "B25104_011E",
    "B25104_012E",
    "B25104_013E",
    "B25104_014E",
    "B25104_015E",
    "B25104_016E",
    "B25104_017E"
	)
a19housing = acs19_housing[var_housing]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19housing = a19housing %>%
  rename(
    housing_less_100 = B25104_002E,
    housing_100 = B25104_003E,
    housing_200 = B25104_004E,
    housing_300 = B25104_005E,
    housing_400 = B25104_006E,
    housing_500 = B25104_007E,
    housing_600 = B25104_008E,
    housing_700 = B25104_009E,
    housing_800 = B25104_010E,
    housing_900 = B25104_011E,
    housing_1000 = B25104_012E,
    housing_1500 = B25104_013E,
    housing_2000 = B25104_014E,
    housing_2500 = B25104_015E,
    housing_more_3000 = B25104_016E,
    housing_rent_free = B25104_017E
    )

# show table dim
print("Show table dimensions below:")
head(a19housing)
dim(a19housing)

# 6. 2019 American Community Survey (ACS) Single-Year Estimates - Education Attainment
# * Table: [B15003]
# * Columns:
#   B15003_002E: Estimate!!Total:!!No schooling completed
#   B15003_003E: Estimate!!Total:!!Nursery school
#   B15003_004E: Estimate!!Total:!!Kindergarten
#   B15003_005E: Estimate!!Total:!!1st grade
#   B15003_006E: Estimate!!Total:!!2nd grade
#   B15003_007E: Estimate!!Total:!!3rd grade
#   B15003_008E: Estimate!!Total:!!4th grade
#   B15003_009E: Estimate!!Total:!!5th grade
#   B15003_010E: Estimate!!Total:!!6th grade
#   B15003_011E: Estimate!!Total:!!7th grade
#   B15003_012E: Estimate!!Total:!!8th grade
#   B15003_013E: Estimate!!Total:!!9th grade
#   B15003_014E: Estimate!!Total:!!10th grade
#   B15003_015E: Estimate!!Total:!!11th grade
#   B15003_016E: Estimate!!Total:!!12th grade, no diploma
#   B15003_017E: Estimate!!Total:!!Regular high school diploma
#   B15003_018E: Estimate!!Total:!!GED or alternative credential
#   B15003_019E: Estimate!!Total:!!Some college, less than 1 year
#   B15003_020E: Estimate!!Total:!!Some college, 1 or more years, no degree
#   B15003_021E: Estimate!!Total:!!Associate's degree
#   B15003_022E: Estimate!!Total:!!Bachelor's degree
#   B15003_023E: Estimate!!Total:!!Master's degree
#   B15003_024E: Estimate!!Total:!!Professional school degree
#   B15003_025E: Estimate!!Total:!!Doctorate degree

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_edu = c(
	"GEO_ID",
    "B15003_002E",
    "B15003_003E",
    "B15003_004E",
    "B15003_005E",
    "B15003_006E",
    "B15003_007E",
    "B15003_008E",
    "B15003_009E",
    "B15003_010E",
    "B15003_011E",
    "B15003_012E",
    "B15003_013E",
    "B15003_014E",
    "B15003_015E",
    "B15003_016E",
    "B15003_017E",
    "B15003_018E",
    "B15003_019E",
    "B15003_020E",
    "B15003_021E",
    "B15003_022E",
    "B15003_023E",
    "B15003_024E",
    "B15003_025E"
	)
a19edu = acs19_education[var_edu]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19edu = a19edu %>%
  rename(
    edu_none = B15003_002E,
    edu_nursery = B15003_003E,
    edu_kinder = B15003_004E,
    edu_grade1 = B15003_005E,
    edu_grade2 = B15003_006E,
    edu_grade3 = B15003_007E,
    edu_grade4 = B15003_008E,
    edu_grade5 = B15003_009E,
    edu_grade6 = B15003_010E,
    edu_grade7 = B15003_011E,
    edu_grade8 = B15003_012E,
    edu_grade9 = B15003_013E,
    edu_grade10 = B15003_014E,
    edu_grade11 = B15003_015E,
    edu_grade12 = B15003_016E,
    edu_hs_only = B15003_017E,
    edu_ged_only = B15003_018E,
    edu_univ_less1yr = B15003_019E,
    edu_univ_more1yr = B15003_020E,
    edu_associate = B15003_021E,
    edu_bachelor = B15003_022E,
    edu_master = B15003_023E,
    edu_professional = B15003_024E,
    edu_doctorate = B15003_025E
    )

# show table dim
print("Show table dimensions below:")
head(a19edu)
dim(a19edu)

# 7. 2019 American Community Survey (ACS) Single-Year Estimates - Commute Mode
# * Table: [B08101]
# * Columns:
#   B08101_009E: Estimate!!Total:!!Car, truck, or van - drove alone:
#   B08101_017E: Estimate!!Total:!!Car, truck, or van - carpooled:
#   B08101_025E: Estimate!!Total:!!Public transportation (excluding taxicab):
#   B08101_033E: Estimate!!Total:!!Walked:
#   B08101_041E: Estimate!!Total:!!Taxicab, motorcycle, bicycle, or other means:
#   B08101_049E: Estimate!!Total:!!Worked from home

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_commute = c(
	"GEO_ID",
    "B08101_009E",
    "B08101_017E",
    "B08101_025E",
    "B08101_033E",
    "B08101_041E",
    "B08101_049E"
	)
a19commute = acs19_commute[var_commute]

# rename columns
# ref: https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/
a19commute = a19commute %>%
  rename(
    commute_car = B08101_009E,
    commute_carpool = B08101_017E,
    commute_transit = B08101_025E,
    commute_walk = B08101_033E,
    commute_other = B08101_041E,
    commute_remote = B08101_049E
    )

# show table dim
print("Show table dimensions below:")
head(a19commute)
dim(a19commute)

# 8. 2019 American Community Survey (ACS) Single-Year Estimates - Race
# * Table: [B02001]
# * Columns:
#   B02001_002E: Estimate!!Total:!!White alone
#   B02001_003E: Estimate!!Total:!!Black or African American alone
#   B02001_004E: Estimate!!Total:!!American Indian and Alaska Native alone
#   B02001_005E: Estimate!!Total:!!Asian alone
#   B02001_006E: Estimate!!Total:!!Native Hawaiian and Other Pacific Islander alone
#   B02001_007E: Estimate!!Total:!!Some other race alone
#   B02001_008E: Estimate!!Total:!!Two or more races:

# subset by columns
# ref: https://www.statmethods.net/management/subset.html
var_race = c(
	"GEO_ID",
    "B02001_002E",
    "B02001_003E",
    "B02001_004E",
    "B02001_005E",
    "B02001_006E",
    "B02001_007E",
    "B02001_008E"
    )
a19race = acs19_race[var_race]

# show table dim
print("Show table dimensions below:")
head(a19race)
dim(a19race)

```
